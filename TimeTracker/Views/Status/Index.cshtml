@using NodaTime
@model TimeTracker.Controllers.StatusController.Flumm

@{
    ViewBag.Title = "Your time tracking statistics";
    var currentDay = LocalDate.FromWeekYearWeekAndDay(Model.FirstDay.WeekYear, Model.FirstDay.WeekOfWeekYear, IsoDayOfWeek.Monday);
}

@helper WorkPerDay(LocalDate date)
{
    if (@Model.WorkPerDay.ContainsKey(date))
    {
        <td>@Model.WorkPerDay[date].AmountOfWork.ToTimeSpan().TotalHours.ToString("N1")</td>
    }
    else
    {
        <td>&nbsp;</td>    
    }
}


@for (var weekNumber = Model.FirstDay.WeekOfWeekYear; weekNumber < Model.LastDate.WeekOfWeekYear; weekNumber++)
{
    <table class="table table-bordered">
        <caption>Activity week @weekNumber</caption>
        <thead>
            <tr>
                <th>Activity</th>
                <th>Mån</th>
                <th>Tis</th>
                <th>Ons</th>
                <th>Tor</th>
                <th>Fre</th>
                <th>Lör</th>
                <th>Sön</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <th colspan="8" style="text-align: center">Total amount of work: 28h
                </th>
            </tr>
        </tfoot>
        <tbody>
            <tr>
                <td>Work</td>
                @for (int i = 1; i <= 7; i++)
                {
                    @WorkPerDay(currentDay)
                    currentDay = currentDay.PlusDays(1);
                }
            </tr>
        </tbody>
    </table>
}



